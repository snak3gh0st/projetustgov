---
phase: 04-data-dashboard
plan: 04
type: execute
wave: 3
depends_on: ["04-02", "04-03"]
files_modified: []
autonomous: false

must_haves:
  truths:
    - "Dashboard displays row counts per entity table"
    - "Extraction history shows last 30 days of pipeline runs"
    - "Data tables are browsable with search, sort, and filter"
    - "Dashboard shows data freshness"
    - "Propostas can be explored with related entities"
    - "CSV export works on each data table"
    - "Portuguese characters render correctly"
  artifacts: []
  key_links: []
---

<objective>
Verify the complete Streamlit dashboard by running it locally and confirming all success criteria from the phase definition are met: metrics cards, entity browsing, cross-filtering, CSV export, extraction history, data freshness, and Portuguese character rendering.

Purpose: Visual and functional verification that cannot be automated â€” confirms the dashboard works as intended from a user's perspective.

Output: User confirmation that the dashboard meets all 7 success criteria.
</objective>

<execution_context>
@/Users/pauloloureiro/.claude/get-shit-done/workflows/execute-plan.md
@/Users/pauloloureiro/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/04-data-dashboard/04-CONTEXT.md
</context>

<tasks>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Complete PROJETUS Streamlit dashboard with 6 pages: Home overview with metric cards and data table, 4 entity detail pages (Propostas, Programas, Apoiadores, Emendas) with cross-filtering, and Extraction History page with pipeline run status.</what-built>
  <how-to-verify>
    1. Start the dashboard: `uv run streamlit run src/dashboard/streamlit_app.py`
    2. Open http://localhost:8501 in your browser

    **Home page checks:**
    - Verify metric cards show row counts for all 4 entity tables
    - Verify data freshness indicator shows last extraction time
    - Verify recent propostas table is visible below metrics without scrolling
    - Verify pipeline status summary is shown

    **Entity pages checks (navigate via sidebar):**
    - Propostas: verify search works, filter by estado/situacao, sort columns
    - Select a proposta row: verify drill-down shows related programas/apoiadores/emendas
    - Navigate to Programas: verify it auto-filters to show only the related programa
    - Navigate to Apoiadores: verify it auto-filters to related apoiadores
    - Navigate to Emendas: verify it auto-filters to related emendas
    - Click "Show all" on any page: verify it clears the filter

    **CSV export checks:**
    - On any entity page, click the CSV export button
    - Open the downloaded CSV: verify Portuguese characters (accents, cedilhas) render correctly

    **Extraction History checks:**
    - Navigate to Extraction History page
    - Verify pipeline runs show with color-coded status (green/yellow/red)
    - Verify time range selector works (7/14/30 days)
    - Verify row counts and duration are visible

    **Portuguese characters:**
    - Check that names like "Sao Paulo", "Brasilia", entity names with accents render correctly throughout
  </how-to-verify>
  <resume-signal>Type "approved" if all checks pass, or describe specific issues to fix.</resume-signal>
</task>

</tasks>

<verification>
All 7 phase success criteria verified by human:
1. Row counts per entity table displayed
2. Extraction history with 30-day pipeline runs
3. Browsable data tables with search/sort/filter
4. Data freshness indicator
5. Propostas exploration with related entities
6. Deployable on Railway (config exists)
7. Portuguese characters correct
</verification>

<success_criteria>
User confirms "approved" after testing all dashboard functionality.
</success_criteria>

<output>
After completion, create `.planning/phases/04-data-dashboard/04-04-SUMMARY.md`
</output>
